name: flutter_monorepo

# Define los paquetes dentro del monorepo
packages:
  - apps/* # Ruta donde est谩n las aplicaciones
  - packages/* # Ruta donde est谩n los paquetes

# Configuraci贸n de comandos
command:
  bootstrap:
    usePubspecOverrides: true # Respeta las sobrescrituras y vincula correctamente los paquetes locales
    runPubGetInParallel: true # Instala dependencias en paralelo para acelerar melos bootstrap.
    generateIntelliJIdeFiles: true # Genera archivos de configuraci贸n para IDEs como IntelliJ y Android Studio.
  version:
    workspaceChangelog: true # Genera un changelog a nivel global del monorepo

# Configuraci贸n para IDEs
ide:
  vscode:
    workspace: true # Genera autom谩ticamente la configuraci贸n de espacio de trabajo para VS Code

scripts:
  #  Configuraci贸n inicial del monorepo
  setup:
    run: melos bootstrap
    description: "Instala todas las dependencias del monorepo y configura los paquetes"

  #  Limpieza de cach茅 y builds
  clean:
    run: melos exec -- flutter clean
    description: "Limpia todos los builds y cach茅s en los paquetes"

  #  Verifica que todas las dependencias est茅n correctamente instaladas
  check-dependencies:
    run: melos exec -- flutter pub get
    description: "Verifica que todas las dependencias est茅n actualizadas"

  #  An谩lisis de c贸digo en todo el monorepo
  analyze:
    run: melos exec -- flutter analyze .
    description: "Ejecuta an谩lisis est谩tico en todos los paquetes"

  #  Formateo de c贸digo
  format:
    run: melos exec -- dart format . --set-exit-if-changed
    description: "Formatea el c贸digo en todos los paquetes seg煤n las reglas de Dart"

  #  Ejecuta pruebas en todos los paquetes
  test:
    run: melos exec -- flutter test
    description: "Ejecuta todas las pruebas en los paquetes del monorepo"

  #  Ejecuta pruebas con cobertura y genera un informe
  test-coverage:
    run: |
      melos exec -- flutter test --coverage
      genhtml coverage/lcov.info -o coverage/html
    description: "Ejecuta las pruebas con cobertura y genera un informe"

  #  Actualizaci贸n de dependencias en todo el monorepo
  upgrade:
    run: melos exec -- flutter pub upgrade
    description: "Actualiza todas las dependencias en los paquetes"

  #  Generaci贸n de c贸digo (para paquetes que usen build_runner)
  build-runner:
    run: melos exec -- dart run build_runner build --delete-conflicting-outputs
    description: "Genera c贸digo autom谩ticamente en todos los paquetes"

  #  Verificaci贸n de errores en la generaci贸n de c贸digo
  check-build-runner:
    run: melos exec -- dart run build_runner check
    description: "Verifica si los archivos generados con build_runner est谩n actualizados"

  #  Correcci贸n autom谩tica de errores en el c贸digo
  fix:
    run: melos exec -- dart fix --apply
    description: "Aplica correcciones autom谩ticas en el c贸digo de todos los paquetes"

  #  Ejecuta build_runner en modo observador
  generate:
    run: melos exec -- dart run build_runner watch
    description: "Ejecuta build_runner en modo observador para generar c贸digo autom谩ticamente"

# Importa los scripts desde un archivo externo
#include: melos_scripts.yaml